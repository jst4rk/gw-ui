"use strict";(self.webpackChunkgw_ui=self.webpackChunkgw_ui||[]).push([[587],{6587:(_i,ot,o)=>{o.r(ot),o.d(ot,{GatewaysModule:()=>mi});var w=o(6895),$t=o(9299),lt=o(529),_=o(4006),g=o(7155),X=o(7974),P=o(6308),N=o(4859),T=o(5412),U=o(1561),ct=o(4144),W=o(7009),G=o(9549),dt=o(7392),j=o(4385),Kt=o(3590),M=o(262),ut=o(9646),Jt=o(6451),Qt=o(8505),I=o(5730),qt=o(4641);const ft=function jt(t,e){return t===e||t!=t&&e!=e},L=function Vt(t,e){for(var n=t.length;n--;)if(ft(t[n][0],e))return n;return-1};var te=Array.prototype.splice;function D(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}D.prototype.clear=function Xt(){this.__data__=[],this.size=0},D.prototype.delete=function ee(t){var e=this.__data__,n=L(e,t);return!(n<0||(n==e.length-1?e.pop():te.call(e,n,1),--this.size,0))},D.prototype.get=function ae(t){var e=this.__data__,n=L(e,t);return n<0?void 0:e[n][1]},D.prototype.has=function ie(t){return L(this.__data__,t)>-1},D.prototype.set=function oe(t,e){var n=this.__data__,r=L(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};const R=D;var ht=o(9329);const O=(0,o(3858).Z)(Object,"create");var Se=Object.prototype.hasOwnProperty;var be=Object.prototype.hasOwnProperty;function x(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}x.prototype.clear=function ye(){this.__data__=O?O(null):{},this.size=0},x.prototype.delete=function we(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},x.prototype.get=function Ie(t){var e=this.__data__;if(O){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Se.call(e,t)?e[t]:void 0},x.prototype.has=function Ee(t){var e=this.__data__;return O?void 0!==e[t]:be.call(e,t)},x.prototype.set=function Pe(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=O&&void 0===e?"__lodash_hash_undefined__":e,this};const pt=x,F=function Fe(t,e){var n=t.__data__;return function Le(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map};function b(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}b.prototype.clear=function Ue(){this.size=0,this.__data__={hash:new pt,map:new(ht.Z||R),string:new pt}},b.prototype.delete=function Ye(t){var e=F(this,t).delete(t);return this.size-=e?1:0,e},b.prototype.get=function Be(t){return F(this,t).get(t)},b.prototype.has=function $e(t){return F(this,t).has(t)},b.prototype.set=function Je(t,e){var n=F(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};const Y=b;function E(t){var e=this.__data__=new R(t);this.size=e.size}E.prototype.clear=function ce(){this.__data__=new R,this.size=0},E.prototype.delete=function ue(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},E.prototype.get=function he(t){return this.__data__.get(t)},E.prototype.has=function me(t){return this.__data__.has(t)},E.prototype.set=function Xe(t,e){var n=this.__data__;if(n instanceof R){var r=n.__data__;if(!ht.Z||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Y(r)}return n.set(t,e),this.size=n.size,this};const H=E;function B(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Y;++e<n;)this.add(t[e])}B.prototype.add=B.prototype.push=function Ve(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},B.prototype.has=function tn(t){return this.__data__.has(t)};const nn=B,rn=function an(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1},on=function sn(t,e){return t.has(e)};const mt=function dn(t,e,n,r,i,s){var l=1&n,c=t.length,u=e.length;if(c!=u&&!(l&&u>c))return!1;var d=s.get(t),p=s.get(e);if(d&&p)return d==e&&p==t;var h=-1,f=!0,A=2&n?new nn:void 0;for(s.set(t,e),s.set(e,t);++h<c;){var m=t[h],v=e[h];if(r)var C=l?r(v,m,h,e,t,s):r(m,v,h,t,e,s);if(void 0!==C){if(C)continue;f=!1;break}if(A){if(!rn(e,function(Z,S){if(!on(A,S)&&(m===Z||i(m,Z,n,r,s)))return A.push(S)})){f=!1;break}}else if(m!==v&&!i(m,v,n,r,s)){f=!1;break}}return s.delete(t),s.delete(e),f};var z=o(8492);const _t=o(5946).Z.Uint8Array,pn=function hn(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n},_n=function mn(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n};var gt=z.Z?z.Z.prototype:void 0,V=gt?gt.valueOf:void 0;var y=o(4177);var Hn=Object.prototype.propertyIsEnumerable,vt=Object.getOwnPropertySymbols;const zn=vt?function(t){return null==t?[]:(t=Object(t),function Mn(t,e){for(var n=-1,r=null==t?0:t.length,i=0,s=[];++n<r;){var l=t[n];e(l,n,t)&&(s[i++]=l)}return s}(vt(t),function(e){return Hn.call(t,e)}))}:function Rn(){return[]};var yt=o(4825),k=o(5202),Qn=/^(?:0|[1-9]\d*)$/;const At=function qn(t,e){var n=typeof t;return!!(e=e??9007199254740991)&&("number"==n||"symbol"!=n&&Qn.test(t))&&t>-1&&t%1==0&&t<e};var wt=o(4711),Wn=Object.prototype.hasOwnProperty;const Vn=function jn(t,e){var n=(0,y.Z)(t),r=!n&&(0,yt.Z)(t),i=!n&&!r&&(0,k.Z)(t),s=!n&&!r&&!i&&(0,wt.Z)(t),l=n||r||i||s,c=l?function $n(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],u=c.length;for(var d in t)(e||Wn.call(t,d))&&(!l||!("length"==d||i&&("offset"==d||"parent"==d)||s&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||At(d,u)))&&c.push(d);return c};var kn=o(9606),Ct=o(8706);const tt=function ta(t){return(0,Ct.Z)(t)?Vn(t):(0,kn.Z)(t)},Tt=function ea(t){return function Nn(t,e,n){var r=e(t);return(0,y.Z)(t)?r:function On(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}(r,n(t))}(t,tt,zn)};var ra=Object.prototype.hasOwnProperty;var Zt=o(4116),St="[object Arguments]",It="[object Array]",$="[object Object]",Dt=Object.prototype.hasOwnProperty;const da=function ca(t,e,n,r,i,s){var l=(0,y.Z)(t),c=(0,y.Z)(e),u=l?It:(0,Zt.Z)(t),d=c?It:(0,Zt.Z)(e),p=(u=u==St?$:u)==$,h=(d=d==St?$:d)==$,f=u==d;if(f&&(0,k.Z)(t)){if(!(0,k.Z)(e))return!1;l=!0,p=!1}if(f&&!p)return s||(s=new H),l||(0,wt.Z)(t)?mt(t,e,n,r,i,s):function En(t,e,n,r,i,s,l){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!s(new _t(t),new _t(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ft(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=pn;case"[object Set]":if(c||(c=_n),t.size!=e.size&&!(1&r))return!1;var d=l.get(t);if(d)return d==e;r|=2,l.set(t,e);var p=mt(c(t),c(e),r,i,s,l);return l.delete(t),p;case"[object Symbol]":if(V)return V.call(t)==V.call(e)}return!1}(t,e,u,n,r,i,s);if(!(1&n)){var A=p&&Dt.call(t,"__wrapped__"),m=h&&Dt.call(e,"__wrapped__");if(A||m){var v=A?t.value():t,C=m?e.value():e;return s||(s=new H),i(v,C,n,r,s)}}return!!f&&(s||(s=new H),function ia(t,e,n,r,i,s){var l=1&n,c=Tt(t),u=c.length;if(u!=Tt(e).length&&!l)return!1;for(var h=u;h--;){var f=c[h];if(!(l?f in e:ra.call(e,f)))return!1}var A=s.get(t),m=s.get(e);if(A&&m)return A==e&&m==t;var v=!0;s.set(t,e),s.set(e,t);for(var C=l;++h<u;){var Z=t[f=c[h]],S=e[f];if(r)var zt=l?r(S,Z,f,e,t,s):r(Z,S,f,t,e,s);if(!(void 0===zt?Z===S||i(Z,S,n,r,s):zt)){v=!1;break}C||(C="constructor"==f)}if(v&&!C){var Q=t.constructor,q=e.constructor;Q!=q&&"constructor"in t&&"constructor"in e&&!("function"==typeof Q&&Q instanceof Q&&"function"==typeof q&&q instanceof q)&&(v=!1)}return s.delete(t),s.delete(e),v}(t,e,n,r,i,s))};var et=o(214);const bt=function xt(t,e,n,r,i){return t===e||(null==t||null==e||!(0,et.Z)(t)&&!(0,et.Z)(e)?t!=t&&e!=e:da(t,e,n,r,xt,i))};var nt=o(1999);const Et=function ma(t){return t==t&&!(0,nt.Z)(t)},Gt=function va(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}},Aa=function ya(t){var e=function _a(t){for(var e=tt(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Et(i)]}return e}(t);return 1==e.length&&e[0][2]?Gt(e[0][0],e[0][1]):function(n){return n===t||function ha(t,e,n,r){var i=n.length,s=i,l=!r;if(null==t)return!s;for(t=Object(t);i--;){var c=n[i];if(l&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++i<s;){var u=(c=n[i])[0],d=t[u],p=c[1];if(l&&c[2]){if(void 0===d&&!(u in t))return!1}else{var h=new H;if(r)var f=r(d,p,u,t,e,h);if(!(void 0===f?bt(p,d,3,r,h):f))return!1}}return!0}(n,t,e)}};var wa=o(7079);const K=function Ta(t){return"symbol"==typeof t||(0,et.Z)(t)&&"[object Symbol]"==(0,wa.Z)(t)};var Za=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Sa=/^\w*$/;const at=function Ia(t,e){if((0,y.Z)(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!K(t))||Sa.test(t)||!Za.test(t)||null!=e&&t in Object(e)};var Da="Expected a function";function rt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Da);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var l=t.apply(this,r);return n.cache=s.set(i,l)||s,l};return n.cache=new(rt.Cache||Y),n}rt.Cache=Y;const xa=rt;var Oa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pa=/\\(\\)?/g;const Ua=function Ea(t){var e=xa(t,function(r){return 500===n.size&&n.clear(),r}),n=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Oa,function(n,r,i,s){e.push(i?s.replace(Pa,"$1"):r||n)}),e});var Ot=z.Z?z.Z.prototype:void 0,Pt=Ot?Ot.toString:void 0;const Fa=function Nt(t){if("string"==typeof t)return t;if((0,y.Z)(t))return function Ma(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}(t,Nt)+"";if(K(t))return Pt?Pt.call(t):"";var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},Ut=function Ba(t,e){return(0,y.Z)(t)?t:at(t,e)?[t]:Ua(function Ya(t){return null==t?"":Fa(t)}(t))};const J=function $a(t){if("string"==typeof t||K(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},Mt=function Ka(t,e){for(var n=0,r=(e=Ut(e,t)).length;null!=t&&n<r;)t=t[J(e[n++])];return n&&n==r?t:void 0},Xa=function qa(t,e){return null!=t&&e in Object(t)};var Wa=o(8696);const tr=function ka(t,e){return null!=t&&function ja(t,e,n){for(var r=-1,i=(e=Ut(e,t)).length,s=!1;++r<i;){var l=J(e[r]);if(!(s=null!=t&&n(t,l)))break;t=t[l]}return s||++r!=i?s:!!(i=null==t?0:t.length)&&(0,Wa.Z)(i)&&At(l,i)&&((0,y.Z)(t)||(0,yt.Z)(t))}(t,e,Xa)};const rr=function ar(t,e){return at(t)&&Et(e)?Gt(J(t),e):function(n){var r=function Ja(t,e,n){var r=null==t?void 0:Mt(t,e);return void 0===r?n:r}(n,t);return void 0===r&&r===e?tr(n,t):bt(e,r,3)}},sr=function ir(t){return t},fr=function ur(t){return at(t)?function or(t){return function(e){return e?.[t]}}(J(t)):function cr(t){return function(e){return Mt(e,t)}}(t)},Lt=function hr(t){return"function"==typeof t?t:null==t?sr:"object"==typeof t?(0,y.Z)(t)?rr(t[0],t[1]):Aa(t):fr(t)};var vr=/\s/;var wr=/^\s+/;const Tr=function Cr(t){return t&&t.slice(0,function yr(t){for(var e=t.length;e--&&vr.test(t.charAt(e)););return e}(t)+1).replace(wr,"")};var Zr=/^[-+]0x[0-9a-f]+$/i,Sr=/^0b[01]+$/i,Ir=/^0o[0-7]+$/i,Dr=parseInt;const Or=function Gr(t){return t?Infinity===(t=function xr(t){if("number"==typeof t)return t;if(K(t))return NaN;if((0,nt.Z)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=(0,nt.Z)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Tr(t);var n=Sr.test(t);return n||Ir.test(t)?Dr(t.slice(2),n?2:8):Zr.test(t)?NaN:+t}(t))||-Infinity===t?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var Ur=Math.max;const Rr=function pr(t){return function(e,n,r){var i=Object(e);if(!(0,Ct.Z)(e)){var s=Lt(n);e=tt(e),n=function(c){return s(i[c],c,i)}}var l=t(e,n,r);return l>-1?i[s?e[l]:l]:void 0}}(function Mr(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:function Pr(t){var e=Or(t),n=e%1;return e==e?n?e-n:e:0}(n);return i<0&&(i=Ur(r+i,0)),function _r(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}(t,Lt(e),i)});var Yt=o(2843);class Fr{static ipv4(e){return(0,I.qg)(e.value)?null:{invalidIPv4:{value:e.value}}}}var Yr=o(6881),a=o(4650),Hr=o(2340);let it=(()=>{class t{constructor(n){this._httpClient=n,this.gatewaysApiUrl=`${Hr.N.apiUrl}/gateways`}getAll(n){return this._httpClient.get(this.gatewaysApiUrl,{params:n})}create(n){return this._httpClient.post(`${this.gatewaysApiUrl}`,n)}edit(n,r){return this._httpClient.patch(`${this.gatewaysApiUrl}/${n}`,r)}delete(n){return this._httpClient.delete(`${this.gatewaysApiUrl}/${n}`)}}return t.\u0275fac=function(n){return new(n||t)(a.LFG(lt.eN))},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Br=o(3238);function zr(t,e){1&t&&(a.TgZ(0,"mat-error"),a._uU(1," The Serial ID field is required "),a.qZA())}function $r(t,e){1&t&&(a.TgZ(0,"mat-error"),a._uU(1," The Name field is required "),a.qZA())}function Kr(t,e){1&t&&(a.TgZ(0,"mat-error"),a._uU(1," The IP field is required "),a.qZA())}function Jr(t,e){1&t&&(a.TgZ(0,"mat-error"),a._uU(1," The IP field has an invalid format "),a.qZA())}function Qr(t,e){if(1&t&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&t){const n=a.oxw();a.xp6(1),a.AsE(" (+",((null==n.controls.peripheralDevices.value?null:n.controls.peripheralDevices.value.length)||0)-1," ",2===(null==n.controls.peripheralDevices.value?null:n.controls.peripheralDevices.value.length)?"other":"others",") ")}}function qr(t,e){if(1&t&&(a.TgZ(0,"mat-option",16),a._uU(1),a.ALo(2,"titlecase"),a.qZA()),2&t){const n=e.$implicit,r=a.oxw();a.Q6J("value",n._id)("disabled",r.disableOption(n._id)),a.xp6(1),a.hij(" ",a.lcZ(2,3,n.vendor)+" - "+n.uid," ")}}let Xr=(()=>{class t{constructor(n,r,i,s,l){this.data=n,this._fb=r,this._snackBar=i,this._dialogRef=s,this._gatewaysService=l,this.selectedPeriphericalDevices=[]}get isEditMode(){return!(0,I.Qt)(this.data.gatewayData)}get controls(){return this.addEditForm.controls}get peripheralDevices(){return this.data.devices||[]}get maxDevices(){return 10}ngOnInit(){if(this.loading=!1,this.addEditForm=this._fb.group({name:["",_.kI.required],serialId:["",_.kI.required],ipv4Address:["",[_.kI.required,Fr.ipv4]],peripheralDevices:[""]}),this.isEditMode){const{peripheralDevices:n,...r}=this.data.gatewayData;this.addEditForm.patchValue({peripheralDevices:n.map(i=>i._id),...r})}}openSnackBar(n,r="OK"){this._snackBar.open(n,r,{duration:4e3,verticalPosition:"top"})}addSaveGateway(){if(!(0,Yr.J)(this.addEditForm))return void this.openSnackBar("Please enter all required fields");const n=this.addEditForm.value;!0===(this.loading=!0,this.isEditMode)?this._gatewaysService.edit(this.data.gatewayData._id,n).pipe((0,M.K)(r=>(this.openSnackBar((0,I.Yu)(r)),(0,Yt._)(()=>r)))).subscribe(()=>{this.openSnackBar("Gateway Edited Successfully"),this.loading=!1,this._dialogRef.close("edit")}):this._gatewaysService.create(n).pipe((0,M.K)(r=>(this.openSnackBar((0,I.Yu)(r)),(0,Yt._)(()=>r)))).subscribe(()=>{this.openSnackBar("Gateway Created Successfully"),this.loading=!1,this._dialogRef.close("add")})}getDeviceLabel(n){return Rr(this.peripheralDevices,{_id:n})?.vendor||""}checkLimit(n){this.selectedPeriphericalDevices=n.value}disableOption(n=""){return 10===this.selectedPeriphericalDevices.length&&!this.selectedPeriphericalDevices.includes(n)}}return t.\u0275fac=function(n){return new(n||t)(a.Y36(T.WI),a.Y36(_.qu),a.Y36(W.ux),a.Y36(T.so),a.Y36(it))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-gateways-add-edit"]],decls:39,vars:13,consts:[[3,"formGroup"],["mat-dialog-title",""],[1,"flex","flex-col","px-6"],[1,"w-full","flex","gap-6","flex-row"],["floatLabel","always",1,"w-1/2"],["matInput","","formControlName","serialId"],[4,"ngIf"],["matInput","","formControlName","name"],[1,"mt-4","w-full","flex","gap-6","flex-row"],["matInput","","formControlName","ipv4Address"],["formControlName","peripheralDevices","multiple","",3,"selectionChange"],["peripheralDevicesRef",""],[3,"value","disabled",4,"ngFor","ngForOf"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary",3,"click"],[3,"value","disabled"]],template:function(n,r){1&n&&(a.TgZ(0,"form",0)(1,"h1",1),a._uU(2),a.qZA(),a.TgZ(3,"div",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),a._uU(7,"Serial ID"),a.qZA(),a._UZ(8,"input",5),a.YNc(9,zr,2,0,"mat-error",6),a.qZA(),a.TgZ(10,"mat-form-field",4)(11,"mat-label"),a._uU(12,"Name"),a.qZA(),a._UZ(13,"input",7),a.YNc(14,$r,2,0,"mat-error",6),a.qZA()(),a.TgZ(15,"div",8)(16,"mat-form-field",4)(17,"mat-label"),a._uU(18,"IP"),a.qZA(),a._UZ(19,"input",9),a.YNc(20,Kr,2,0,"mat-error",6),a.YNc(21,Jr,2,0,"mat-error",6),a.qZA(),a.TgZ(22,"mat-form-field",4)(23,"mat-label"),a._uU(24,"Peripherical Devices"),a.qZA(),a.TgZ(25,"mat-select",10,11),a.NdJ("selectionChange",function(s){return r.checkLimit(s)}),a.TgZ(27,"mat-select-trigger"),a._uU(28),a.ALo(29,"titlecase"),a.YNc(30,Qr,2,2,"span",6),a.qZA(),a.YNc(31,qr,3,5,"mat-option",12),a.qZA(),a.TgZ(32,"mat-hint"),a._uU(33),a.qZA()()()(),a.TgZ(34,"div",13)(35,"button",14),a._uU(36,"Cancel"),a.qZA(),a.TgZ(37,"button",15),a.NdJ("click",function(){return r.addSaveGateway()}),a._uU(38),a.qZA()()()),2&n&&(a.Q6J("formGroup",r.addEditForm),a.xp6(2),a.hij("",r.isEditMode?"Edit":"Add"," Gateway"),a.xp6(7),a.Q6J("ngIf",(r.controls.serialId.dirty||r.controls.serialId.touched)&&r.controls.serialId.hasError("required")),a.xp6(5),a.Q6J("ngIf",(r.controls.name.dirty||r.controls.name.touched)&&r.controls.name.hasError("required")),a.xp6(6),a.Q6J("ngIf",(r.controls.ipv4Address.dirty||r.controls.ipv4Address.touched)&&r.controls.ipv4Address.hasError("required")),a.xp6(1),a.Q6J("ngIf",(r.controls.ipv4Address.dirty||r.controls.ipv4Address.touched)&&r.controls.ipv4Address.hasError("invalidIPv4")),a.xp6(7),a.hij(" ",a.lcZ(29,11,r.getDeviceLabel(null==r.controls.peripheralDevices.value?null:r.controls.peripheralDevices.value[0]))," "),a.xp6(2),a.Q6J("ngIf",((null==r.controls.peripheralDevices.value?null:r.controls.peripheralDevices.value.length)||0)>1),a.xp6(1),a.Q6J("ngForOf",r.peripheralDevices),a.xp6(2),a.hij(" Max: ",r.maxDevices," "),a.xp6(5),a.Oqu(r.isEditMode?"Save":"Add"))},dependencies:[w.sg,w.O5,_._Y,_.Fj,_.JJ,_.JL,_.sg,_.u,N.lW,G.KE,G.hX,G.bx,G.TO,j.gD,j.$L,Br.ey,T.ZT,T.uh,T.H8,ct.Nt,w.rS],styles:[".dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end!important;padding:0 24px 24px}.w-half[_ngcontent-%COMP%]{width:50%}"]}),t})();var st=o(1135),Wr=o(8746);class jr{constructor(e){this._gatewaysService=e,this.gatewaysSubject=new st.X([]),this.metaSubject=new st.X({total:0}),this.loadingSubject=new st.X(!1),this.loading$=this.loadingSubject.asObservable()}connect(){return this.gatewaysSubject.asObservable()}disconnect(){this.gatewaysSubject.complete(),this.loadingSubject.complete()}loadGateways(e={}){this.loadingSubject.next(!0),this._gatewaysService.getAll(e).pipe((0,M.K)(()=>(0,ut.of)({data:[],meta:{total:0}})),(0,Wr.x)(()=>this.loadingSubject.next(!1))).subscribe(n=>{this.gatewaysSubject.next(n.data),this.metaSubject.next(n.meta)})}get meta$(){return this.metaSubject.asObservable()}}var Bt=o(8855);function Vr(t,e){1&t&&(a.TgZ(0,"th",18),a._uU(1,"Serial ID"),a.qZA())}function kr(t,e){if(1&t&&(a.TgZ(0,"td",19),a._uU(1),a.qZA()),2&t){const n=e.$implicit;a.xp6(1),a.Oqu(n.serialId)}}function ti(t,e){1&t&&(a.TgZ(0,"th",18),a._uU(1,"Name"),a.qZA())}function ei(t,e){if(1&t&&(a.TgZ(0,"td",19),a._uU(1),a.qZA()),2&t){const n=e.$implicit;a.xp6(1),a.Oqu(n.name)}}function ni(t,e){1&t&&(a.TgZ(0,"th",18),a._uU(1,"IP"),a.qZA())}function ai(t,e){if(1&t&&(a.TgZ(0,"td",19),a._uU(1),a.qZA()),2&t){const n=e.$implicit;a.xp6(1),a.Oqu(n.ipv4Address)}}function ri(t,e){1&t&&(a.TgZ(0,"th",20),a._uU(1,"Peripherical Devices"),a.qZA())}function ii(t,e){if(1&t&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&t){const n=a.oxw().$implicit;a.xp6(1),a.AsE(" (+",(n.peripheralDevices.length||0)-1," ",2===n.peripheralDevices.length?"other":"others",") ")}}function si(t,e){if(1&t&&(a.TgZ(0,"td",19),a._uU(1),a.ALo(2,"titlecase"),a.YNc(3,ii,2,2,"span",21),a.qZA()),2&t){const n=e.$implicit;a.xp6(1),a.hij(" ",a.lcZ(2,2,n.peripheralDevices[0].vendor)+" - "+n.peripheralDevices[0].uid," "),a.xp6(2),a.Q6J("ngIf",(n.peripheralDevices.length||0)>1)}}function oi(t,e){1&t&&(a.TgZ(0,"th",18),a._uU(1,"Created At"),a.qZA())}function li(t,e){if(1&t&&(a.TgZ(0,"td",19),a._uU(1),a.ALo(2,"date"),a.qZA()),2&t){const n=e.$implicit;a.xp6(1),a.Oqu(a.xi3(2,1,n.createdAt,"medium"))}}function ci(t,e){1&t&&(a.TgZ(0,"th",18),a._uU(1,"Actions"),a.qZA())}function di(t,e){if(1&t){const n=a.EpF();a.TgZ(0,"td",19)(1,"button",22)(2,"mat-icon"),a._uU(3,"more_vert"),a.qZA()(),a.TgZ(4,"mat-menu",null,23)(6,"button",24),a.NdJ("click",function(){const s=a.CHM(n).$implicit,l=a.oxw();return a.KtG(l.openAddEditDialog(s))}),a._uU(7,"Edit"),a.qZA(),a.TgZ(8,"button",24),a.NdJ("click",function(){const s=a.CHM(n).$implicit,l=a.oxw();return a.KtG(l.openDeleteDialog(s._id))}),a._uU(9,"Remove"),a.qZA()()()}if(2&t){const n=a.MAs(5);a.xp6(1),a.Q6J("matMenuTriggerFor",n)}}function ui(t,e){1&t&&a._UZ(0,"tr",25)}function fi(t,e){1&t&&a._UZ(0,"tr",26)}const hi=function(){return[5,10,20]},pi=[{path:"",component:(()=>{class t{constructor(n,r,i,s){this._gatewaysService=n,this._deviceService=r,this._dialog=i,this._snackBar=s,this.devices=[],this.displayedColumns=["serialId","name","ipv4Address","peripheralDevices","createdAt","actions"]}get params(){let n=`${"desc"===this.sort?.direction?"-":""}${this.sort?.active}`;return((0,I.Qt)(this.sort)||(0,I.Qt)(this.sort?.active))&&(n="-createdAt"),{page:this.paginator?.pageIndex||0,limit:this.paginator?.pageSize||10,sort:n}}ngOnInit(){this._deviceService.getAll().pipe((0,M.K)(()=>(0,ut.of)({data:[],meta:{total:0}}))).subscribe(n=>{this.devices=n.data}),this.dataSource=new jr(this._gatewaysService),this.dataSource.loadGateways(this.params)}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,Jt.T)(this.sort.sortChange,this.paginator.page).pipe((0,Qt.b)(()=>this.loadGateways())).subscribe()}loadGateways(){this.dataSource.loadGateways(this.params)}openAddEditDialog(n){this._dialog.open(Xr,{width:"550px",disableClose:!0,data:{devices:this.devices,gatewayData:n}}).afterClosed().subscribe(i=>{i&&this.dataSource.loadGateways(this.params)})}openSnackBar(n,r="OK"){this._snackBar.open(n,r,{duration:4e3,verticalPosition:"top"})}openDeleteDialog(n){this._dialog.open(qt.$,{data:{title:"Delete Gateway",message:"Are you sure you want to delete this gateway?"}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._gatewaysService.delete(n).subscribe(()=>{this.openSnackBar("Gateway deleted successfully!"),this.dataSource.loadGateways(this.params)})})}}return t.\u0275fac=function(n){return new(n||t)(a.Y36(it),a.Y36(Bt.I),a.Y36(T.uw),a.Y36(W.ux))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-gateways"]],viewQuery:function(n,r){if(1&n&&(a.Gf(X.NW,5),a.Gf(P.YE,5)),2&n){let i;a.iGM(i=a.CRH())&&(r.paginator=i.first),a.iGM(i=a.CRH())&&(r.sort=i.first)}},decls:29,vars:10,consts:[[1,"flex","mx-10","my-5"],["mat-flat-button","","color","primary",1,"ml-auto",3,"click"],["aria-hidden","false","aria-label","Add New gateway Icon","fontIcon","add"],[1,"mat-elevation-z8","mx-10"],["mat-table","","matSort","","aria-label","Elements",1,"full-width-table",3,"dataSource"],["matColumnDef","serialId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","ipv4Address"],["matColumnDef","peripheralDevices"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",1,"border-t",3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],[4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,r){if(1&n&&(a.TgZ(0,"div",0)(1,"button",1),a.NdJ("click",function(){return r.openAddEditDialog()}),a._UZ(2,"mat-icon",2),a._uU(3," Add New Gateway "),a.qZA()(),a.TgZ(4,"div",3)(5,"table",4),a.ynx(6,5),a.YNc(7,Vr,2,0,"th",6),a.YNc(8,kr,2,1,"td",7),a.BQk(),a.ynx(9,8),a.YNc(10,ti,2,0,"th",6),a.YNc(11,ei,2,1,"td",7),a.BQk(),a.ynx(12,9),a.YNc(13,ni,2,0,"th",6),a.YNc(14,ai,2,1,"td",7),a.BQk(),a.ynx(15,10),a.YNc(16,ri,2,0,"th",11),a.YNc(17,si,4,4,"td",7),a.BQk(),a.ynx(18,12),a.YNc(19,oi,2,0,"th",6),a.YNc(20,li,3,4,"td",7),a.BQk(),a.ynx(21,13),a.YNc(22,ci,2,0,"th",6),a.YNc(23,di,10,1,"td",7),a.BQk(),a.YNc(24,ui,1,0,"tr",14),a.YNc(25,fi,1,0,"tr",15),a.qZA(),a._UZ(26,"mat-paginator",16,17),a.ALo(28,"async"),a.qZA()),2&n){let i;a.xp6(5),a.Q6J("dataSource",r.dataSource),a.xp6(19),a.Q6J("matHeaderRowDef",r.displayedColumns),a.xp6(1),a.Q6J("matRowDefColumns",r.displayedColumns),a.xp6(1),a.Q6J("length",null==(i=a.lcZ(28,7,r.dataSource.meta$))?null:i.total)("pageIndex",0)("pageSize",10)("pageSizeOptions",a.DdM(9,hi))}},dependencies:[w.O5,g.BZ,g.fO,g.as,g.w1,g.Dz,g.nj,g.ge,g.ev,g.XQ,g.Gk,X.NW,P.YE,P.nU,N.lW,N.RK,dt.Hw,U.VK,U.OP,U.p6,w.Ov,w.rS,w.uU]}),t})()}];let mi=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({providers:[it,Bt.I],imports:[w.ez,$t.Bz.forChild(pi),Kt.D,_.UX,lt.JF,g.p0,X.TU,P.JX,N.ot,dt.Ps,j.LD,T.Is,ct.c,U.Tx,W.ZX,G.lN]}),t})()}}]);