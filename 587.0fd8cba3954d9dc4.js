"use strict";(self.webpackChunkgw_ui=self.webpackChunkgw_ui||[]).push([[587],{6587:(Ti,lt,o)=>{o.r(lt),o.d(lt,{GatewaysModule:()=>Zi});var y=o(6895),Jt=o(9299),ct=o(529),g=o(4006),_=o(7155),W=o(7974),P=o(6308),N=o(4859),Z=o(5412),U=o(1561),dt=o(4144),j=o(7009),G=o(9549),ut=o(7392),V=o(4385),k=o(3162),zt=o(1572),Kt=o(3590),M=o(262),ft=o(9646),qt=o(6451),Xt=o(8505),S=o(5730),Wt=o(4641);const ht=function kt(t,e){return t===e||t!=t&&e!=e},L=function te(t,e){for(var a=t.length;a--;)if(ht(t[a][0],e))return a;return-1};var ne=Array.prototype.splice;function I(t){var e=-1,a=null==t?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}I.prototype.clear=function jt(){this.__data__=[],this.size=0},I.prototype.delete=function ae(t){var e=this.__data__,a=L(e,t);return!(a<0||(a==e.length-1?e.pop():ne.call(e,a,1),--this.size,0))},I.prototype.get=function ie(t){var e=this.__data__,a=L(e,t);return a<0?void 0:e[a][1]},I.prototype.has=function oe(t){return L(this.__data__,t)>-1},I.prototype.set=function ce(t,e){var a=this.__data__,r=L(a,t);return r<0?(++this.size,a.push([t,e])):a[r][1]=e,this};const R=I;var pt=o(9329);const O=(0,o(3858).Z)(Object,"create");var Ie=Object.prototype.hasOwnProperty;var Ge=Object.prototype.hasOwnProperty;function x(t){var e=-1,a=null==t?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}x.prototype.clear=function we(){this.__data__=O?O(null):{},this.size=0},x.prototype.delete=function Ze(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},x.prototype.get=function xe(t){var e=this.__data__;if(O){var a=e[t];return"__lodash_hash_undefined__"===a?void 0:a}return Ie.call(e,t)?e[t]:void 0},x.prototype.has=function Oe(t){var e=this.__data__;return O?void 0!==e[t]:Ge.call(e,t)},x.prototype.set=function Ue(t,e){var a=this.__data__;return this.size+=this.has(t)?0:1,a[t]=O&&void 0===e?"__lodash_hash_undefined__":e,this};const mt=x,Y=function $e(t,e){var a=t.__data__;return function Ye(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?a["string"==typeof e?"string":"hash"]:a.map};function D(t){var e=-1,a=null==t?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}D.prototype.clear=function Le(){this.size=0,this.__data__={hash:new mt,map:new(pt.Z||R),string:new mt}},D.prototype.delete=function Be(t){var e=Y(this,t).delete(t);return this.size-=e?1:0,e},D.prototype.get=function Qe(t){return Y(this,t).get(t)},D.prototype.has=function ze(t){return Y(this,t).has(t)},D.prototype.set=function qe(t,e){var a=Y(this,t),r=a.size;return a.set(t,e),this.size+=a.size==r?0:1,this};const F=D;function E(t){var e=this.__data__=new R(t);this.size=e.size}E.prototype.clear=function ue(){this.__data__=new R,this.size=0},E.prototype.delete=function he(t){var e=this.__data__,a=e.delete(t);return this.size=e.size,a},E.prototype.get=function me(t){return this.__data__.get(t)},E.prototype.has=function _e(t){return this.__data__.has(t)},E.prototype.set=function je(t,e){var a=this.__data__;if(a instanceof R){var r=a.__data__;if(!pt.Z||r.length<199)return r.push([t,e]),this.size=++a.size,this;a=this.__data__=new F(r)}return a.set(t,e),this.size=a.size,this};const $=E;function B(t){var e=-1,a=null==t?0:t.length;for(this.__data__=new F;++e<a;)this.add(t[e])}B.prototype.add=B.prototype.push=function tn(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},B.prototype.has=function nn(t){return this.__data__.has(t)};const rn=B,on=function sn(t,e){for(var a=-1,r=null==t?0:t.length;++a<r;)if(e(t[a],a,t))return!0;return!1},cn=function ln(t,e){return t.has(e)};const gt=function fn(t,e,a,r,i,s){var l=1&a,c=t.length,u=e.length;if(c!=u&&!(l&&u>c))return!1;var d=s.get(t),p=s.get(e);if(d&&p)return d==e&&p==t;var h=-1,f=!0,w=2&a?new rn:void 0;for(s.set(t,e),s.set(e,t);++h<c;){var m=t[h],v=e[h];if(r)var C=l?r(v,m,h,e,t,s):r(m,v,h,t,e,s);if(void 0!==C){if(C)continue;f=!1;break}if(w){if(!on(e,function(T,b){if(!cn(w,b)&&(m===T||i(m,T,a,r,s)))return w.push(b)})){f=!1;break}}else if(m!==v&&!i(m,v,a,r,s)){f=!1;break}}return s.delete(t),s.delete(e),f};var H=o(8492);const _t=o(5946).Z.Uint8Array,gn=function mn(t){var e=-1,a=Array(t.size);return t.forEach(function(r,i){a[++e]=[i,r]}),a},vn=function _n(t){var e=-1,a=Array(t.size);return t.forEach(function(r){a[++e]=r}),a};var vt=H.Z?H.Z.prototype:void 0,tt=vt?vt.valueOf:void 0;var A=o(4177);var Hn=Object.prototype.propertyIsEnumerable,yt=Object.getOwnPropertySymbols;const Jn=yt?function(t){return null==t?[]:(t=Object(t),function Rn(t,e){for(var a=-1,r=null==t?0:t.length,i=0,s=[];++a<r;){var l=t[a];e(l,a,t)&&(s[i++]=l)}return s}(yt(t),function(e){return Hn.call(t,e)}))}:function Fn(){return[]};var At=o(4825),et=o(5202),Xn=/^(?:0|[1-9]\d*)$/;const wt=function Wn(t,e){var a=typeof t;return!!(e=e??9007199254740991)&&("number"==a||"symbol"!=a&&Xn.test(t))&&t>-1&&t%1==0&&t<e};var Ct=o(4711),Vn=Object.prototype.hasOwnProperty;const ta=function kn(t,e){var a=(0,A.Z)(t),r=!a&&(0,At.Z)(t),i=!a&&!r&&(0,et.Z)(t),s=!a&&!r&&!i&&(0,Ct.Z)(t),l=a||r||i||s,c=l?function zn(t,e){for(var a=-1,r=Array(t);++a<t;)r[a]=e(a);return r}(t.length,String):[],u=c.length;for(var d in t)(e||Vn.call(t,d))&&(!l||!("length"==d||i&&("offset"==d||"parent"==d)||s&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||wt(d,u)))&&c.push(d);return c};var ea=o(9606),Zt=o(8706);const nt=function na(t){return(0,Zt.Z)(t)?ta(t):(0,ea.Z)(t)},Tt=function aa(t){return function Mn(t,e,a){var r=e(t);return(0,A.Z)(t)?r:function Nn(t,e){for(var a=-1,r=e.length,i=t.length;++a<r;)t[i+a]=e[a];return t}(r,a(t))}(t,nt,Jn)};var sa=Object.prototype.hasOwnProperty;var bt=o(4116),St="[object Arguments]",It="[object Array]",Q="[object Object]",xt=Object.prototype.hasOwnProperty;const fa=function ua(t,e,a,r,i,s){var l=(0,A.Z)(t),c=(0,A.Z)(e),u=l?It:(0,bt.Z)(t),d=c?It:(0,bt.Z)(e),p=(u=u==St?Q:u)==Q,h=(d=d==St?Q:d)==Q,f=u==d;if(f&&(0,et.Z)(t)){if(!(0,et.Z)(e))return!1;l=!0,p=!1}if(f&&!p)return s||(s=new $),l||(0,Ct.Z)(t)?gt(t,e,a,r,i,s):function On(t,e,a,r,i,s,l){switch(a){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!s(new _t(t),new _t(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ht(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=gn;case"[object Set]":if(c||(c=vn),t.size!=e.size&&!(1&r))return!1;var d=l.get(t);if(d)return d==e;r|=2,l.set(t,e);var p=gt(c(t),c(e),r,i,s,l);return l.delete(t),p;case"[object Symbol]":if(tt)return tt.call(t)==tt.call(e)}return!1}(t,e,u,a,r,i,s);if(!(1&a)){var w=p&&xt.call(t,"__wrapped__"),m=h&&xt.call(e,"__wrapped__");if(w||m){var v=w?t.value():t,C=m?e.value():e;return s||(s=new $),i(v,C,a,r,s)}}return!!f&&(s||(s=new $),function oa(t,e,a,r,i,s){var l=1&a,c=Tt(t),u=c.length;if(u!=Tt(e).length&&!l)return!1;for(var h=u;h--;){var f=c[h];if(!(l?f in e:sa.call(e,f)))return!1}var w=s.get(t),m=s.get(e);if(w&&m)return w==e&&m==t;var v=!0;s.set(t,e),s.set(e,t);for(var C=l;++h<u;){var T=t[f=c[h]],b=e[f];if(r)var Qt=l?r(b,T,f,e,t,s):r(T,b,f,t,e,s);if(!(void 0===Qt?T===b||i(T,b,a,r,s):Qt)){v=!1;break}C||(C="constructor"==f)}if(v&&!C){var q=t.constructor,X=e.constructor;q!=X&&"constructor"in t&&"constructor"in e&&!("function"==typeof q&&q instanceof q&&"function"==typeof X&&X instanceof X)&&(v=!1)}return s.delete(t),s.delete(e),v}(t,e,a,r,i,s))};var at=o(214);const Et=function Dt(t,e,a,r,i){return t===e||(null==t||null==e||!(0,at.Z)(t)&&!(0,at.Z)(e)?t!=t&&e!=e:fa(t,e,a,r,Dt,i))};var rt=o(1999);const Gt=function _a(t){return t==t&&!(0,rt.Z)(t)},Ot=function Aa(t,e){return function(a){return null!=a&&a[t]===e&&(void 0!==e||t in Object(a))}},Ca=function wa(t){var e=function va(t){for(var e=nt(t),a=e.length;a--;){var r=e[a],i=t[r];e[a]=[r,i,Gt(i)]}return e}(t);return 1==e.length&&e[0][2]?Ot(e[0][0],e[0][1]):function(a){return a===t||function ma(t,e,a,r){var i=a.length,s=i,l=!r;if(null==t)return!s;for(t=Object(t);i--;){var c=a[i];if(l&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++i<s;){var u=(c=a[i])[0],d=t[u],p=c[1];if(l&&c[2]){if(void 0===d&&!(u in t))return!1}else{var h=new $;if(r)var f=r(d,p,u,t,e,h);if(!(void 0===f?Et(p,d,3,r,h):f))return!1}}return!0}(a,t,e)}};var Za=o(7079);const J=function ba(t){return"symbol"==typeof t||(0,at.Z)(t)&&"[object Symbol]"==(0,Za.Z)(t)};var Sa=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ia=/^\w*$/;const it=function xa(t,e){if((0,A.Z)(t))return!1;var a=typeof t;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=t&&!J(t))||Ia.test(t)||!Sa.test(t)||null!=e&&t in Object(e)};var Da="Expected a function";function st(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Da);var a=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=a.cache;if(s.has(i))return s.get(i);var l=t.apply(this,r);return a.cache=s.set(i,l)||s,l};return a.cache=new(st.Cache||F),a}st.Cache=F;const Ea=st;var Na=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ua=/\\(\\)?/g;const La=function Oa(t){var e=Ea(t,function(r){return 500===a.size&&a.clear(),r}),a=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Na,function(a,r,i,s){e.push(i?s.replace(Ua,"$1"):r||a)}),e});var Pt=H.Z?H.Z.prototype:void 0,Nt=Pt?Pt.toString:void 0;const $a=function Ut(t){if("string"==typeof t)return t;if((0,A.Z)(t))return function Ra(t,e){for(var a=-1,r=null==t?0:t.length,i=Array(r);++a<r;)i[a]=e(t[a],a,t);return i}(t,Ut)+"";if(J(t))return Nt?Nt.call(t):"";var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},Mt=function Qa(t,e){return(0,A.Z)(t)?t:it(t,e)?[t]:La(function Ba(t){return null==t?"":$a(t)}(t))};const z=function za(t){if("string"==typeof t||J(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},Lt=function Ka(t,e){for(var a=0,r=(e=Mt(e,t)).length;null!=t&&a<r;)t=t[z(e[a++])];return a&&a==r?t:void 0},ja=function Wa(t,e){return null!=t&&e in Object(t)};var Va=o(8696);const nr=function er(t,e){return null!=t&&function ka(t,e,a){for(var r=-1,i=(e=Mt(e,t)).length,s=!1;++r<i;){var l=z(e[r]);if(!(s=null!=t&&a(t,l)))break;t=t[l]}return s||++r!=i?s:!!(i=null==t?0:t.length)&&(0,Va.Z)(i)&&wt(l,i)&&((0,A.Z)(t)||(0,At.Z)(t))}(t,e,ja)};const sr=function ir(t,e){return it(t)&&Gt(e)?Ot(z(t),e):function(a){var r=function qa(t,e,a){var r=null==t?void 0:Lt(t,e);return void 0===r?a:r}(a,t);return void 0===r&&r===e?nr(a,t):Et(e,r,3)}},lr=function or(t){return t},pr=function hr(t){return it(t)?function cr(t){return function(e){return e?.[t]}}(z(t)):function ur(t){return function(e){return Lt(e,t)}}(t)},Rt=function mr(t){return"function"==typeof t?t:null==t?lr:"object"==typeof t?(0,A.Z)(t)?sr(t[0],t[1]):Ca(t):pr(t)};var Ar=/\s/;var Zr=/^\s+/;const br=function Tr(t){return t&&t.slice(0,function wr(t){for(var e=t.length;e--&&Ar.test(t.charAt(e)););return e}(t)+1).replace(Zr,"")};var Sr=/^[-+]0x[0-9a-f]+$/i,Ir=/^0b[01]+$/i,xr=/^0o[0-7]+$/i,Dr=parseInt;const Nr=function Pr(t){return t?Infinity===(t=function Er(t){if("number"==typeof t)return t;if(J(t))return NaN;if((0,rt.Z)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=(0,rt.Z)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=br(t);var a=Ir.test(t);return a||xr.test(t)?Dr(t.slice(2),a?2:8):Sr.test(t)?NaN:+t}(t))||-Infinity===t?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var Lr=Math.max;const Fr=function gr(t){return function(e,a,r){var i=Object(e);if(!(0,Zt.Z)(e)){var s=Rt(a);e=nt(e),a=function(c){return s(i[c],c,i)}}var l=t(e,a,r);return l>-1?i[s?e[l]:l]:void 0}}(function Rr(t,e,a){var r=null==t?0:t.length;if(!r)return-1;var i=null==a?0:function Ur(t){var e=Nr(t),a=e%1;return e==e?a?e-a:e:0}(a);return i<0&&(i=Lr(r+i,0)),function vr(t,e,a,r){for(var i=t.length,s=a+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}(t,Rt(e),i)});var K=o(1135),$r=o(7579),Br=o(2722),$t=o(2843);class Hr{static ipv4(e){return(0,S.qg)(e.value)?null:{invalidIPv4:{value:e.value}}}}var Qr=o(6881),n=o(4650),Jr=o(2340);let ot=(()=>{class t{constructor(a){this._httpClient=a,this.gatewaysApiUrl=`${Jr.N.apiUrl}/gateways`}getAll(a){return this._httpClient.get(this.gatewaysApiUrl,{params:a})}create(a){return this._httpClient.post(`${this.gatewaysApiUrl}`,a)}edit(a,r){return this._httpClient.patch(`${this.gatewaysApiUrl}/${a}`,r)}delete(a){return this._httpClient.delete(`${this.gatewaysApiUrl}/${a}`)}}return t.\u0275fac=function(a){return new(a||t)(n.LFG(ct.eN))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var zr=o(3238);function Kr(t,e){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," The Serial ID field is required "),n.qZA())}function qr(t,e){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," The Name field is required "),n.qZA())}function Xr(t,e){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," The IP field is required "),n.qZA())}function Wr(t,e){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," The IP field has an invalid format "),n.qZA())}function jr(t,e){if(1&t&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&t){const a=n.oxw();n.xp6(1),n.AsE(" (+",((null==a.controls.peripheralDevices.value?null:a.controls.peripheralDevices.value.length)||0)-1," ",2===(null==a.controls.peripheralDevices.value?null:a.controls.peripheralDevices.value.length)?"other":"others",") ")}}function Vr(t,e){if(1&t&&(n.TgZ(0,"mat-option",17),n._uU(1),n.ALo(2,"titlecase"),n.qZA()),2&t){const a=e.$implicit,r=n.oxw();n.Q6J("value",a._id)("disabled",r.disableOption(a._id)),n.xp6(1),n.hij(" ",n.lcZ(2,3,a.vendor)+" - "+a.uid," ")}}function kr(t,e){1&t&&n._UZ(0,"mat-progress-bar",18)}let ti=(()=>{class t{constructor(a,r,i,s,l){this.data=a,this._fb=r,this._snackBar=i,this._dialogRef=s,this._gatewaysService=l,this.loadingSubject=new K.X(!1),this._unsubscribeAll=new $r.x,this.selectedPeriphericalDevices=[],this.loading$=this.loadingSubject.asObservable()}get isEditMode(){return!(0,S.Qt)(this.data.gatewayData)}get controls(){return this.addEditForm.controls}get peripheralDevices(){return this.data.devices||[]}get maxDevices(){return 10}ngOnInit(){if(this.addEditForm=this._fb.group({name:["",g.kI.required],serialId:["",g.kI.required],ipv4Address:["",[g.kI.required,Hr.ipv4]],peripheralDevices:[""]}),this.isEditMode){const{peripheralDevices:a,...r}=this.data.gatewayData;this.addEditForm.patchValue({peripheralDevices:a.map(i=>i._id),...r})}this.loading$.pipe((0,Br.R)(this._unsubscribeAll)).subscribe(a=>{a?this.addEditForm.disable():this.addEditForm.enable()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}openSnackBar(a,r="OK"){this._snackBar.open(a,r,{duration:4e3,verticalPosition:"top"})}addSaveGateway(){if(!(0,Qr.J)(this.addEditForm))return void this.openSnackBar("Please enter all required fields");const a=this.addEditForm.value;!0===(this.loadingSubject.next(!0),this.isEditMode)?this._gatewaysService.edit(this.data.gatewayData._id,a).pipe((0,M.K)(r=>(this.openSnackBar((0,S.Yu)(r)),(0,$t._)(()=>r)))).subscribe(()=>{this.openSnackBar("Gateway Edited Successfully"),this.loadingSubject.next(!1),this._dialogRef.close("edit")}):this._gatewaysService.create(a).pipe((0,M.K)(r=>(this.openSnackBar((0,S.Yu)(r)),(0,$t._)(()=>r)))).subscribe(()=>{this.openSnackBar("Gateway Created Successfully"),this.loadingSubject.next(!1),this._dialogRef.close("add")})}getDeviceLabel(a){return Fr(this.peripheralDevices,{_id:a})?.vendor||""}checkLimit(a){this.selectedPeriphericalDevices=a.value}disableOption(a=""){return 10===this.selectedPeriphericalDevices.length&&!this.selectedPeriphericalDevices.includes(a)}}return t.\u0275fac=function(a){return new(a||t)(n.Y36(Z.WI),n.Y36(g.qu),n.Y36(j.ux),n.Y36(Z.so),n.Y36(ot))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-gateways-add-edit"]],decls:43,vars:22,consts:[[3,"formGroup"],["mat-dialog-title",""],[1,"flex","flex-col","px-6"],[1,"w-full","flex","gap-6","flex-row"],["floatLabel","always",1,"w-1/2"],["matInput","","formControlName","serialId"],[4,"ngIf"],["matInput","","formControlName","name"],[1,"mt-4","w-full","flex","gap-6","flex-row"],["matInput","","formControlName","ipv4Address"],["formControlName","peripheralDevices","multiple","",3,"selectionChange"],["peripheralDevicesRef",""],[3,"value","disabled",4,"ngFor","ngForOf"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","","mat-dialog-close","",3,"disabled"],["mat-flat-button","","color","primary",3,"disabled","click"],["mode","indeterminate",4,"ngIf"],[3,"value","disabled"],["mode","indeterminate"]],template:function(a,r){1&a&&(n.TgZ(0,"form",0)(1,"h1",1),n._uU(2),n.qZA(),n.TgZ(3,"div",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),n._uU(7,"Serial ID"),n.qZA(),n._UZ(8,"input",5),n.YNc(9,Kr,2,0,"mat-error",6),n.qZA(),n.TgZ(10,"mat-form-field",4)(11,"mat-label"),n._uU(12,"Name"),n.qZA(),n._UZ(13,"input",7),n.YNc(14,qr,2,0,"mat-error",6),n.qZA()(),n.TgZ(15,"div",8)(16,"mat-form-field",4)(17,"mat-label"),n._uU(18,"IP"),n.qZA(),n._UZ(19,"input",9),n.YNc(20,Xr,2,0,"mat-error",6),n.YNc(21,Wr,2,0,"mat-error",6),n.qZA(),n.TgZ(22,"mat-form-field",4)(23,"mat-label"),n._uU(24,"Peripherical Devices"),n.qZA(),n.TgZ(25,"mat-select",10,11),n.NdJ("selectionChange",function(s){return r.checkLimit(s)}),n.TgZ(27,"mat-select-trigger"),n._uU(28),n.ALo(29,"titlecase"),n.YNc(30,jr,2,2,"span",6),n.qZA(),n.YNc(31,Vr,3,5,"mat-option",12),n.qZA(),n.TgZ(32,"mat-hint"),n._uU(33),n.qZA()()()(),n.TgZ(34,"div",13)(35,"button",14),n.ALo(36,"async"),n._uU(37,"Cancel"),n.qZA(),n.TgZ(38,"button",15),n.NdJ("click",function(){return r.addSaveGateway()}),n.ALo(39,"async"),n._uU(40),n.qZA()(),n.YNc(41,kr,1,0,"mat-progress-bar",16),n.ALo(42,"async"),n.qZA()),2&a&&(n.Q6J("formGroup",r.addEditForm),n.xp6(2),n.hij("",r.isEditMode?"Edit":"Add"," Gateway"),n.xp6(7),n.Q6J("ngIf",(r.controls.serialId.dirty||r.controls.serialId.touched)&&r.controls.serialId.hasError("required")),n.xp6(5),n.Q6J("ngIf",(r.controls.name.dirty||r.controls.name.touched)&&r.controls.name.hasError("required")),n.xp6(6),n.Q6J("ngIf",(r.controls.ipv4Address.dirty||r.controls.ipv4Address.touched)&&r.controls.ipv4Address.hasError("required")),n.xp6(1),n.Q6J("ngIf",(r.controls.ipv4Address.dirty||r.controls.ipv4Address.touched)&&r.controls.ipv4Address.hasError("invalidIPv4")),n.xp6(7),n.hij(" ",n.lcZ(29,14,r.getDeviceLabel(null==r.controls.peripheralDevices.value?null:r.controls.peripheralDevices.value[0]))," "),n.xp6(2),n.Q6J("ngIf",((null==r.controls.peripheralDevices.value?null:r.controls.peripheralDevices.value.length)||0)>1),n.xp6(1),n.Q6J("ngForOf",r.peripheralDevices),n.xp6(2),n.hij(" Max: ",r.maxDevices," "),n.xp6(2),n.Q6J("disabled",n.lcZ(36,16,r.loading$)),n.xp6(3),n.Q6J("disabled",n.lcZ(39,18,r.loading$)),n.xp6(2),n.Oqu(r.isEditMode?"Save":"Add"),n.xp6(1),n.Q6J("ngIf",n.lcZ(42,20,r.loading$)))},dependencies:[y.sg,y.O5,g._Y,g.Fj,g.JJ,g.JL,g.sg,g.u,N.lW,G.KE,G.hX,G.bx,G.TO,V.gD,V.$L,zr.ey,Z.ZT,Z.uh,Z.H8,dt.Nt,k.pW,y.Ov,y.rS],styles:[".dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end!important;padding:0 24px 24px}.w-half[_ngcontent-%COMP%]{width:50%}"]}),t})();var ei=o(8746);class ni{constructor(e){this._gatewaysService=e,this.gatewaysSubject=new K.X([]),this.metaSubject=new K.X({total:0}),this.loadingSubject=new K.X(!1),this.loading$=this.loadingSubject.asObservable()}connect(){return this.gatewaysSubject.asObservable()}disconnect(){this.gatewaysSubject.complete(),this.loadingSubject.complete()}loadGateways(e={}){this.loadingSubject.next(!0),this._gatewaysService.getAll(e).pipe((0,M.K)(()=>(0,ft.of)({data:[],meta:{total:0}})),(0,ei.x)(()=>this.loadingSubject.next(!1))).subscribe(a=>{this.gatewaysSubject.next(a.data),this.metaSubject.next(a.meta)})}get meta$(){return this.metaSubject.asObservable()}}var Ht=o(8855);function ai(t,e){1&t&&n._UZ(0,"mat-progress-bar",21)}function ri(t,e){1&t&&(n.TgZ(0,"th",22),n._uU(1,"Serial ID"),n.qZA())}function ii(t,e){if(1&t&&(n.TgZ(0,"td",23),n._uU(1),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.Oqu(a.serialId)}}function si(t,e){1&t&&(n.TgZ(0,"th",22),n._uU(1,"Name"),n.qZA())}function oi(t,e){if(1&t&&(n.TgZ(0,"td",23),n._uU(1),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.Oqu(a.name)}}function li(t,e){1&t&&(n.TgZ(0,"th",22),n._uU(1,"IP"),n.qZA())}function ci(t,e){if(1&t&&(n.TgZ(0,"td",23),n._uU(1),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.Oqu(a.ipv4Address)}}function di(t,e){1&t&&(n.TgZ(0,"th",24),n._uU(1,"Peripherical Devices"),n.qZA())}function ui(t,e){if(1&t&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&t){const a=n.oxw(2).$implicit;n.xp6(1),n.AsE(" (+",(a.peripheralDevices.length||0)-1," ",2===a.peripheralDevices.length?"other":"others",") ")}}function fi(t,e){if(1&t&&(n.ynx(0),n._uU(1),n.ALo(2,"titlecase"),n.YNc(3,ui,2,2,"span",27),n.BQk()),2&t){const a=n.oxw().$implicit;n.xp6(1),n.hij(" ",n.lcZ(2,2,a.peripheralDevices[0].vendor)+" - "+a.peripheralDevices[0].uid," "),n.xp6(2),n.Q6J("ngIf",(a.peripheralDevices.length||0)>1)}}function hi(t,e){1&t&&n._uU(0,"--")}function pi(t,e){if(1&t&&(n.TgZ(0,"td",23),n.YNc(1,fi,4,4,"ng-container",25),n.YNc(2,hi,1,0,"ng-template",null,26,n.W1O),n.qZA()),2&t){const a=e.$implicit,r=n.MAs(3);n.xp6(1),n.Q6J("ngIf",a.peripheralDevices.length)("ngIfElse",r)}}function mi(t,e){1&t&&(n.TgZ(0,"th",22),n._uU(1,"Created At"),n.qZA())}function gi(t,e){if(1&t&&(n.TgZ(0,"td",23),n._uU(1),n.ALo(2,"date"),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.Oqu(n.xi3(2,1,a.createdAt,"medium"))}}function _i(t,e){1&t&&(n.TgZ(0,"th",22),n._uU(1,"Actions"),n.qZA())}function vi(t,e){if(1&t){const a=n.EpF();n.TgZ(0,"td",23)(1,"button",28)(2,"mat-icon"),n._uU(3,"more_vert"),n.qZA()(),n.TgZ(4,"mat-menu",null,29)(6,"button",30),n.NdJ("click",function(){const s=n.CHM(a).$implicit,l=n.oxw();return n.KtG(l.openAddEditDialog(s))}),n._uU(7,"Edit"),n.qZA(),n.TgZ(8,"button",30),n.NdJ("click",function(){const s=n.CHM(a).$implicit,l=n.oxw();return n.KtG(l.openDeleteDialog(s._id))}),n._uU(9,"Remove"),n.qZA()()()}if(2&t){const a=n.MAs(5);n.xp6(1),n.Q6J("matMenuTriggerFor",a)}}function yi(t,e){1&t&&n._UZ(0,"tr",31)}function Ai(t,e){1&t&&n._UZ(0,"tr",32)}const wi=function(){return[5,10,20]},Ci=[{path:"",component:(()=>{class t{constructor(a,r,i,s){this._gatewaysService=a,this._deviceService=r,this._dialog=i,this._snackBar=s,this.devices=[],this.displayedColumns=["serialId","name","ipv4Address","peripheralDevices","createdAt","actions"]}get params(){let a=`${"desc"===this.sort?.direction?"-":""}${this.sort?.active}`;return((0,S.Qt)(this.sort)||(0,S.Qt)(this.sort?.active))&&(a="-createdAt"),{page:this.paginator?.pageIndex||0,limit:this.paginator?.pageSize||10,sort:a}}ngOnInit(){this._deviceService.getAll().pipe((0,M.K)(()=>(0,ft.of)({data:[],meta:{total:0}}))).subscribe(a=>{this.devices=a.data}),this.dataSource=new ni(this._gatewaysService),this.dataSource.loadGateways(this.params)}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,qt.T)(this.sort.sortChange,this.paginator.page).pipe((0,Xt.b)(()=>this.loadGateways())).subscribe()}loadGateways(){this.dataSource.loadGateways(this.params)}openAddEditDialog(a){this._dialog.open(ti,{width:"550px",disableClose:!0,data:{devices:this.devices,gatewayData:a}}).afterClosed().subscribe(i=>{i&&this.dataSource.loadGateways(this.params)})}openSnackBar(a,r="OK"){this._snackBar.open(a,r,{duration:4e3,verticalPosition:"top"})}openDeleteDialog(a){this._dialog.open(Wt.$,{data:{title:"Delete Gateway",message:"Are you sure you want to delete this gateway?"}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._gatewaysService.delete(a).subscribe(()=>{this.openSnackBar("Gateway deleted successfully!"),this.dataSource.loadGateways(this.params)})})}}return t.\u0275fac=function(a){return new(a||t)(n.Y36(ot),n.Y36(Ht.I),n.Y36(Z.uw),n.Y36(j.ux))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-gateways"]],viewQuery:function(a,r){if(1&a&&(n.Gf(W.NW,5),n.Gf(P.YE,5)),2&a){let i;n.iGM(i=n.CRH())&&(r.paginator=i.first),n.iGM(i=n.CRH())&&(r.sort=i.first)}},decls:33,vars:13,consts:[[1,"loading-container"],["mode","indeterminate",4,"ngIf"],[1,"flex","mx-10","my-5"],["mat-flat-button","","color","primary",1,"ml-auto",3,"click"],["aria-hidden","false","aria-label","Add New gateway Icon","fontIcon","add"],[1,"shadow-xl","border","rounded-lg","mx-10"],[1,"rounded-lg","overflow-hidden"],["mat-table","","matSort","","aria-label","Elements",1,"full-width-table",3,"dataSource"],["matColumnDef","serialId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","ipv4Address"],["matColumnDef","peripheralDevices"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",1,"border-t",3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],[4,"ngIf","ngIfElse"],["noDevices",""],[4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(a,r){if(1&a&&(n.TgZ(0,"div",0),n.YNc(1,ai,1,0,"mat-progress-bar",1),n.ALo(2,"async"),n.qZA(),n.TgZ(3,"div",2)(4,"button",3),n.NdJ("click",function(){return r.openAddEditDialog()}),n._UZ(5,"mat-icon",4),n._uU(6," Add New Gateway "),n.qZA()(),n.TgZ(7,"div",5)(8,"div",6)(9,"table",7),n.ynx(10,8),n.YNc(11,ri,2,0,"th",9),n.YNc(12,ii,2,1,"td",10),n.BQk(),n.ynx(13,11),n.YNc(14,si,2,0,"th",9),n.YNc(15,oi,2,1,"td",10),n.BQk(),n.ynx(16,12),n.YNc(17,li,2,0,"th",9),n.YNc(18,ci,2,1,"td",10),n.BQk(),n.ynx(19,13),n.YNc(20,di,2,0,"th",14),n.YNc(21,pi,4,2,"td",10),n.BQk(),n.ynx(22,15),n.YNc(23,mi,2,0,"th",9),n.YNc(24,gi,3,4,"td",10),n.BQk(),n.ynx(25,16),n.YNc(26,_i,2,0,"th",9),n.YNc(27,vi,10,1,"td",10),n.BQk(),n.YNc(28,yi,1,0,"tr",17),n.YNc(29,Ai,1,0,"tr",18),n.qZA()(),n._UZ(30,"mat-paginator",19,20),n.ALo(32,"async"),n.qZA()),2&a){let i;n.xp6(1),n.Q6J("ngIf",n.lcZ(2,8,r.dataSource.loading$)),n.xp6(8),n.Q6J("dataSource",r.dataSource),n.xp6(19),n.Q6J("matHeaderRowDef",r.displayedColumns),n.xp6(1),n.Q6J("matRowDefColumns",r.displayedColumns),n.xp6(1),n.Q6J("length",null==(i=n.lcZ(32,10,r.dataSource.meta$))?null:i.total)("pageIndex",0)("pageSize",10)("pageSizeOptions",n.DdM(12,wi))}},dependencies:[y.O5,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,W.NW,P.YE,P.nU,N.lW,N.RK,ut.Hw,U.VK,U.OP,U.p6,k.pW,y.Ov,y.rS,y.uU]}),t})()}];let Zi=(()=>{class t{}return t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({providers:[ot,Ht.I],imports:[y.ez,Jt.Bz.forChild(Ci),Kt.D,g.UX,ct.JF,_.p0,W.TU,P.JX,N.ot,ut.Ps,V.LD,Z.Is,dt.c,U.Tx,j.ZX,G.lN,k.Cv,zt.Cq]}),t})()}}]);