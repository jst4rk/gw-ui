"use strict";(self.webpackChunkgw_ui=self.webpackChunkgw_ui||[]).push([[587],{6587:(vi,ot,o)=>{o.r(ot),o.d(ot,{GatewaysModule:()=>_i});var w=o(6895),Jt=o(9299),lt=o(529),g=o(4006),_=o(7155),X=o(7974),P=o(6308),N=o(4859),T=o(5412),U=o(1561),ct=o(4144),W=o(7009),E=o(9549),dt=o(7392),j=o(4385),ut=o(3162),Kt=o(3590),M=o(262),ft=o(9646),Qt=o(6451),qt=o(8505),I=o(5730),Xt=o(4641);const ht=function Vt(t,e){return t===e||t!=t&&e!=e},L=function kt(t,e){for(var a=t.length;a--;)if(ht(t[a][0],e))return a;return-1};var ee=Array.prototype.splice;function D(t){var e=-1,a=null==t?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}D.prototype.clear=function Wt(){this.__data__=[],this.size=0},D.prototype.delete=function ne(t){var e=this.__data__,a=L(e,t);return!(a<0||(a==e.length-1?e.pop():ee.call(e,a,1),--this.size,0))},D.prototype.get=function re(t){var e=this.__data__,a=L(e,t);return a<0?void 0:e[a][1]},D.prototype.has=function se(t){return L(this.__data__,t)>-1},D.prototype.set=function le(t,e){var a=this.__data__,r=L(a,t);return r<0?(++this.size,a.push([t,e])):a[r][1]=e,this};const R=D;var pt=o(9329);const O=(0,o(3858).Z)(Object,"create");var Ie=Object.prototype.hasOwnProperty;var Ge=Object.prototype.hasOwnProperty;function b(t){var e=-1,a=null==t?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}b.prototype.clear=function Ae(){this.__data__=O?O(null):{},this.size=0},b.prototype.delete=function Ce(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},b.prototype.get=function De(t){var e=this.__data__;if(O){var a=e[t];return"__lodash_hash_undefined__"===a?void 0:a}return Ie.call(e,t)?e[t]:void 0},b.prototype.has=function Ee(t){var e=this.__data__;return O?void 0!==e[t]:Ge.call(e,t)},b.prototype.set=function Ne(t,e){var a=this.__data__;return this.size+=this.has(t)?0:1,a[t]=O&&void 0===e?"__lodash_hash_undefined__":e,this};const mt=b,F=function Ye(t,e){var a=t.__data__;return function Re(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?a["string"==typeof e?"string":"hash"]:a.map};function x(t){var e=-1,a=null==t?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}x.prototype.clear=function Me(){this.size=0,this.__data__={hash:new mt,map:new(pt.Z||R),string:new mt}},x.prototype.delete=function He(t){var e=F(this,t).delete(t);return this.size-=e?1:0,e},x.prototype.get=function ze(t){return F(this,t).get(t)},x.prototype.has=function Je(t){return F(this,t).has(t)},x.prototype.set=function Qe(t,e){var a=F(this,t),r=a.size;return a.set(t,e),this.size+=a.size==r?0:1,this};const Y=x;function G(t){var e=this.__data__=new R(t);this.size=e.size}G.prototype.clear=function de(){this.__data__=new R,this.size=0},G.prototype.delete=function fe(t){var e=this.__data__,a=e.delete(t);return this.size=e.size,a},G.prototype.get=function pe(t){return this.__data__.get(t)},G.prototype.has=function ge(t){return this.__data__.has(t)},G.prototype.set=function We(t,e){var a=this.__data__;if(a instanceof R){var r=a.__data__;if(!pt.Z||r.length<199)return r.push([t,e]),this.size=++a.size,this;a=this.__data__=new Y(r)}return a.set(t,e),this.size=a.size,this};const H=G;function B(t){var e=-1,a=null==t?0:t.length;for(this.__data__=new Y;++e<a;)this.add(t[e])}B.prototype.add=B.prototype.push=function ke(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},B.prototype.has=function en(t){return this.__data__.has(t)};const an=B,sn=function rn(t,e){for(var a=-1,r=null==t?0:t.length;++a<r;)if(e(t[a],a,t))return!0;return!1},ln=function on(t,e){return t.has(e)};const gt=function un(t,e,a,r,i,s){var l=1&a,c=t.length,u=e.length;if(c!=u&&!(l&&u>c))return!1;var d=s.get(t),p=s.get(e);if(d&&p)return d==e&&p==t;var h=-1,f=!0,A=2&a?new an:void 0;for(s.set(t,e),s.set(e,t);++h<c;){var m=t[h],v=e[h];if(r)var C=l?r(v,m,h,e,t,s):r(m,v,h,t,e,s);if(void 0!==C){if(C)continue;f=!1;break}if(A){if(!sn(e,function(Z,S){if(!ln(A,S)&&(m===Z||i(m,Z,a,r,s)))return A.push(S)})){f=!1;break}}else if(m!==v&&!i(m,v,a,r,s)){f=!1;break}}return s.delete(t),s.delete(e),f};var z=o(8492);const _t=o(5946).Z.Uint8Array,mn=function pn(t){var e=-1,a=Array(t.size);return t.forEach(function(r,i){a[++e]=[i,r]}),a},_n=function gn(t){var e=-1,a=Array(t.size);return t.forEach(function(r){a[++e]=r}),a};var vt=z.Z?z.Z.prototype:void 0,V=vt?vt.valueOf:void 0;var y=o(4177);var Bn=Object.prototype.propertyIsEnumerable,yt=Object.getOwnPropertySymbols;const $n=yt?function(t){return null==t?[]:(t=Object(t),function Ln(t,e){for(var a=-1,r=null==t?0:t.length,i=0,s=[];++a<r;){var l=t[a];e(l,a,t)&&(s[i++]=l)}return s}(yt(t),function(e){return Bn.call(t,e)}))}:function Fn(){return[]};var At=o(4825),k=o(5202),qn=/^(?:0|[1-9]\d*)$/;const wt=function Xn(t,e){var a=typeof t;return!!(e=e??9007199254740991)&&("number"==a||"symbol"!=a&&qn.test(t))&&t>-1&&t%1==0&&t<e};var Ct=o(4711),jn=Object.prototype.hasOwnProperty;const kn=function Vn(t,e){var a=(0,y.Z)(t),r=!a&&(0,At.Z)(t),i=!a&&!r&&(0,k.Z)(t),s=!a&&!r&&!i&&(0,Ct.Z)(t),l=a||r||i||s,c=l?function Jn(t,e){for(var a=-1,r=Array(t);++a<t;)r[a]=e(a);return r}(t.length,String):[],u=c.length;for(var d in t)(e||jn.call(t,d))&&(!l||!("length"==d||i&&("offset"==d||"parent"==d)||s&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||wt(d,u)))&&c.push(d);return c};var ta=o(9606),Tt=o(8706);const tt=function ea(t){return(0,Tt.Z)(t)?kn(t):(0,ta.Z)(t)},Zt=function na(t){return function Un(t,e,a){var r=e(t);return(0,y.Z)(t)?r:function Pn(t,e){for(var a=-1,r=e.length,i=t.length;++a<r;)t[i+a]=e[a];return t}(r,a(t))}(t,tt,$n)};var ia=Object.prototype.hasOwnProperty;var St=o(4116),It="[object Arguments]",Dt="[object Array]",$="[object Object]",bt=Object.prototype.hasOwnProperty;const ua=function da(t,e,a,r,i,s){var l=(0,y.Z)(t),c=(0,y.Z)(e),u=l?Dt:(0,St.Z)(t),d=c?Dt:(0,St.Z)(e),p=(u=u==It?$:u)==$,h=(d=d==It?$:d)==$,f=u==d;if(f&&(0,k.Z)(t)){if(!(0,k.Z)(e))return!1;l=!0,p=!1}if(f&&!p)return s||(s=new H),l||(0,Ct.Z)(t)?gt(t,e,a,r,i,s):function En(t,e,a,r,i,s,l){switch(a){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!s(new _t(t),new _t(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ht(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=mn;case"[object Set]":if(c||(c=_n),t.size!=e.size&&!(1&r))return!1;var d=l.get(t);if(d)return d==e;r|=2,l.set(t,e);var p=gt(c(t),c(e),r,i,s,l);return l.delete(t),p;case"[object Symbol]":if(V)return V.call(t)==V.call(e)}return!1}(t,e,u,a,r,i,s);if(!(1&a)){var A=p&&bt.call(t,"__wrapped__"),m=h&&bt.call(e,"__wrapped__");if(A||m){var v=A?t.value():t,C=m?e.value():e;return s||(s=new H),i(v,C,a,r,s)}}return!!f&&(s||(s=new H),function sa(t,e,a,r,i,s){var l=1&a,c=Zt(t),u=c.length;if(u!=Zt(e).length&&!l)return!1;for(var h=u;h--;){var f=c[h];if(!(l?f in e:ia.call(e,f)))return!1}var A=s.get(t),m=s.get(e);if(A&&m)return A==e&&m==t;var v=!0;s.set(t,e),s.set(e,t);for(var C=l;++h<u;){var Z=t[f=c[h]],S=e[f];if(r)var $t=l?r(S,Z,f,e,t,s):r(Z,S,f,t,e,s);if(!(void 0===$t?Z===S||i(Z,S,a,r,s):$t)){v=!1;break}C||(C="constructor"==f)}if(v&&!C){var Q=t.constructor,q=e.constructor;Q!=q&&"constructor"in t&&"constructor"in e&&!("function"==typeof Q&&Q instanceof Q&&"function"==typeof q&&q instanceof q)&&(v=!1)}return s.delete(t),s.delete(e),v}(t,e,a,r,i,s))};var et=o(214);const Gt=function xt(t,e,a,r,i){return t===e||(null==t||null==e||!(0,et.Z)(t)&&!(0,et.Z)(e)?t!=t&&e!=e:ua(t,e,a,r,xt,i))};var nt=o(1999);const Et=function ga(t){return t==t&&!(0,nt.Z)(t)},Ot=function ya(t,e){return function(a){return null!=a&&a[t]===e&&(void 0!==e||t in Object(a))}},wa=function Aa(t){var e=function _a(t){for(var e=tt(t),a=e.length;a--;){var r=e[a],i=t[r];e[a]=[r,i,Et(i)]}return e}(t);return 1==e.length&&e[0][2]?Ot(e[0][0],e[0][1]):function(a){return a===t||function pa(t,e,a,r){var i=a.length,s=i,l=!r;if(null==t)return!s;for(t=Object(t);i--;){var c=a[i];if(l&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++i<s;){var u=(c=a[i])[0],d=t[u],p=c[1];if(l&&c[2]){if(void 0===d&&!(u in t))return!1}else{var h=new H;if(r)var f=r(d,p,u,t,e,h);if(!(void 0===f?Gt(p,d,3,r,h):f))return!1}}return!0}(a,t,e)}};var Ca=o(7079);const J=function Za(t){return"symbol"==typeof t||(0,et.Z)(t)&&"[object Symbol]"==(0,Ca.Z)(t)};var Sa=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ia=/^\w*$/;const at=function Da(t,e){if((0,y.Z)(t))return!1;var a=typeof t;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=t&&!J(t))||Ia.test(t)||!Sa.test(t)||null!=e&&t in Object(e)};var ba="Expected a function";function rt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(ba);var a=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=a.cache;if(s.has(i))return s.get(i);var l=t.apply(this,r);return a.cache=s.set(i,l)||s,l};return a.cache=new(rt.Cache||Y),a}rt.Cache=Y;const xa=rt;var Pa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Na=/\\(\\)?/g;const Ma=function Ea(t){var e=xa(t,function(r){return 500===a.size&&a.clear(),r}),a=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Pa,function(a,r,i,s){e.push(i?s.replace(Na,"$1"):r||a)}),e});var Pt=z.Z?z.Z.prototype:void 0,Nt=Pt?Pt.toString:void 0;const Ya=function Ut(t){if("string"==typeof t)return t;if((0,y.Z)(t))return function La(t,e){for(var a=-1,r=null==t?0:t.length,i=Array(r);++a<r;)i[a]=e(t[a],a,t);return i}(t,Ut)+"";if(J(t))return Nt?Nt.call(t):"";var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},Mt=function za(t,e){return(0,y.Z)(t)?t:at(t,e)?[t]:Ma(function Ha(t){return null==t?"":Ya(t)}(t))};const K=function Ja(t){if("string"==typeof t||J(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e},Lt=function Ka(t,e){for(var a=0,r=(e=Mt(e,t)).length;null!=t&&a<r;)t=t[K(e[a++])];return a&&a==r?t:void 0},Wa=function Xa(t,e){return null!=t&&e in Object(t)};var ja=o(8696);const er=function tr(t,e){return null!=t&&function Va(t,e,a){for(var r=-1,i=(e=Mt(e,t)).length,s=!1;++r<i;){var l=K(e[r]);if(!(s=null!=t&&a(t,l)))break;t=t[l]}return s||++r!=i?s:!!(i=null==t?0:t.length)&&(0,ja.Z)(i)&&wt(l,i)&&((0,y.Z)(t)||(0,At.Z)(t))}(t,e,Wa)};const ir=function rr(t,e){return at(t)&&Et(e)?Ot(K(t),e):function(a){var r=function Qa(t,e,a){var r=null==t?void 0:Lt(t,e);return void 0===r?a:r}(a,t);return void 0===r&&r===e?er(a,t):Gt(e,r,3)}},or=function sr(t){return t},hr=function fr(t){return at(t)?function lr(t){return function(e){return e?.[t]}}(K(t)):function dr(t){return function(e){return Lt(e,t)}}(t)},Rt=function pr(t){return"function"==typeof t?t:null==t?or:"object"==typeof t?(0,y.Z)(t)?ir(t[0],t[1]):wa(t):hr(t)};var yr=/\s/;var Cr=/^\s+/;const Zr=function Tr(t){return t&&t.slice(0,function Ar(t){for(var e=t.length;e--&&yr.test(t.charAt(e)););return e}(t)+1).replace(Cr,"")};var Sr=/^[-+]0x[0-9a-f]+$/i,Ir=/^0b[01]+$/i,Dr=/^0o[0-7]+$/i,br=parseInt;const Pr=function Or(t){return t?Infinity===(t=function xr(t){if("number"==typeof t)return t;if(J(t))return NaN;if((0,nt.Z)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=(0,nt.Z)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Zr(t);var a=Ir.test(t);return a||Dr.test(t)?br(t.slice(2),a?2:8):Sr.test(t)?NaN:+t}(t))||-Infinity===t?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var Mr=Math.max;const Fr=function mr(t){return function(e,a,r){var i=Object(e);if(!(0,Tt.Z)(e)){var s=Rt(a);e=tt(e),a=function(c){return s(i[c],c,i)}}var l=t(e,a,r);return l>-1?i[s?e[l]:l]:void 0}}(function Lr(t,e,a){var r=null==t?0:t.length;if(!r)return-1;var i=null==a?0:function Nr(t){var e=Pr(t),a=e%1;return e==e?a?e-a:e:0}(a);return i<0&&(i=Mr(r+i,0)),function _r(t,e,a,r){for(var i=t.length,s=a+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}(t,Rt(e),i)});var Ht=o(2843);class Yr{static ipv4(e){return(0,I.qg)(e.value)?null:{invalidIPv4:{value:e.value}}}}var Hr=o(6881),n=o(4650),Br=o(2340);let it=(()=>{class t{constructor(a){this._httpClient=a,this.gatewaysApiUrl=`${Br.N.apiUrl}/gateways`}getAll(a){return this._httpClient.get(this.gatewaysApiUrl,{params:a})}create(a){return this._httpClient.post(`${this.gatewaysApiUrl}`,a)}edit(a,r){return this._httpClient.patch(`${this.gatewaysApiUrl}/${a}`,r)}delete(a){return this._httpClient.delete(`${this.gatewaysApiUrl}/${a}`)}}return t.\u0275fac=function(a){return new(a||t)(n.LFG(lt.eN))},t.\u0275prov=n.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var zr=o(3238);function $r(t,e){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," The Serial ID field is required "),n.qZA())}function Jr(t,e){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," The Name field is required "),n.qZA())}function Kr(t,e){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," The IP field is required "),n.qZA())}function Qr(t,e){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," The IP field has an invalid format "),n.qZA())}function qr(t,e){if(1&t&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&t){const a=n.oxw();n.xp6(1),n.AsE(" (+",((null==a.controls.peripheralDevices.value?null:a.controls.peripheralDevices.value.length)||0)-1," ",2===(null==a.controls.peripheralDevices.value?null:a.controls.peripheralDevices.value.length)?"other":"others",") ")}}function Xr(t,e){if(1&t&&(n.TgZ(0,"mat-option",16),n._uU(1),n.ALo(2,"titlecase"),n.qZA()),2&t){const a=e.$implicit,r=n.oxw();n.Q6J("value",a._id)("disabled",r.disableOption(a._id)),n.xp6(1),n.hij(" ",n.lcZ(2,3,a.vendor)+" - "+a.uid," ")}}let Wr=(()=>{class t{constructor(a,r,i,s,l){this.data=a,this._fb=r,this._snackBar=i,this._dialogRef=s,this._gatewaysService=l,this.selectedPeriphericalDevices=[]}get isEditMode(){return!(0,I.Qt)(this.data.gatewayData)}get controls(){return this.addEditForm.controls}get peripheralDevices(){return this.data.devices||[]}get maxDevices(){return 10}ngOnInit(){if(this.loading=!1,this.addEditForm=this._fb.group({name:["",g.kI.required],serialId:["",g.kI.required],ipv4Address:["",[g.kI.required,Yr.ipv4]],peripheralDevices:[""]}),this.isEditMode){const{peripheralDevices:a,...r}=this.data.gatewayData;this.addEditForm.patchValue({peripheralDevices:a.map(i=>i._id),...r})}}openSnackBar(a,r="OK"){this._snackBar.open(a,r,{duration:4e3,verticalPosition:"top"})}addSaveGateway(){if(!(0,Hr.J)(this.addEditForm))return void this.openSnackBar("Please enter all required fields");const a=this.addEditForm.value;!0===(this.loading=!0,this.isEditMode)?this._gatewaysService.edit(this.data.gatewayData._id,a).pipe((0,M.K)(r=>(this.openSnackBar((0,I.Yu)(r)),(0,Ht._)(()=>r)))).subscribe(()=>{this.openSnackBar("Gateway Edited Successfully"),this.loading=!1,this._dialogRef.close("edit")}):this._gatewaysService.create(a).pipe((0,M.K)(r=>(this.openSnackBar((0,I.Yu)(r)),(0,Ht._)(()=>r)))).subscribe(()=>{this.openSnackBar("Gateway Created Successfully"),this.loading=!1,this._dialogRef.close("add")})}getDeviceLabel(a){return Fr(this.peripheralDevices,{_id:a})?.vendor||""}checkLimit(a){this.selectedPeriphericalDevices=a.value}disableOption(a=""){return 10===this.selectedPeriphericalDevices.length&&!this.selectedPeriphericalDevices.includes(a)}}return t.\u0275fac=function(a){return new(a||t)(n.Y36(T.WI),n.Y36(g.qu),n.Y36(W.ux),n.Y36(T.so),n.Y36(it))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-gateways-add-edit"]],decls:39,vars:13,consts:[[3,"formGroup"],["mat-dialog-title",""],[1,"flex","flex-col","px-6"],[1,"w-full","flex","gap-6","flex-row"],["floatLabel","always",1,"w-1/2"],["matInput","","formControlName","serialId"],[4,"ngIf"],["matInput","","formControlName","name"],[1,"mt-4","w-full","flex","gap-6","flex-row"],["matInput","","formControlName","ipv4Address"],["formControlName","peripheralDevices","multiple","",3,"selectionChange"],["peripheralDevicesRef",""],[3,"value","disabled",4,"ngFor","ngForOf"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","color","primary",3,"click"],[3,"value","disabled"]],template:function(a,r){1&a&&(n.TgZ(0,"form",0)(1,"h1",1),n._uU(2),n.qZA(),n.TgZ(3,"div",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),n._uU(7,"Serial ID"),n.qZA(),n._UZ(8,"input",5),n.YNc(9,$r,2,0,"mat-error",6),n.qZA(),n.TgZ(10,"mat-form-field",4)(11,"mat-label"),n._uU(12,"Name"),n.qZA(),n._UZ(13,"input",7),n.YNc(14,Jr,2,0,"mat-error",6),n.qZA()(),n.TgZ(15,"div",8)(16,"mat-form-field",4)(17,"mat-label"),n._uU(18,"IP"),n.qZA(),n._UZ(19,"input",9),n.YNc(20,Kr,2,0,"mat-error",6),n.YNc(21,Qr,2,0,"mat-error",6),n.qZA(),n.TgZ(22,"mat-form-field",4)(23,"mat-label"),n._uU(24,"Peripherical Devices"),n.qZA(),n.TgZ(25,"mat-select",10,11),n.NdJ("selectionChange",function(s){return r.checkLimit(s)}),n.TgZ(27,"mat-select-trigger"),n._uU(28),n.ALo(29,"titlecase"),n.YNc(30,qr,2,2,"span",6),n.qZA(),n.YNc(31,Xr,3,5,"mat-option",12),n.qZA(),n.TgZ(32,"mat-hint"),n._uU(33),n.qZA()()()(),n.TgZ(34,"div",13)(35,"button",14),n._uU(36,"Cancel"),n.qZA(),n.TgZ(37,"button",15),n.NdJ("click",function(){return r.addSaveGateway()}),n._uU(38),n.qZA()()()),2&a&&(n.Q6J("formGroup",r.addEditForm),n.xp6(2),n.hij("",r.isEditMode?"Edit":"Add"," Gateway"),n.xp6(7),n.Q6J("ngIf",(r.controls.serialId.dirty||r.controls.serialId.touched)&&r.controls.serialId.hasError("required")),n.xp6(5),n.Q6J("ngIf",(r.controls.name.dirty||r.controls.name.touched)&&r.controls.name.hasError("required")),n.xp6(6),n.Q6J("ngIf",(r.controls.ipv4Address.dirty||r.controls.ipv4Address.touched)&&r.controls.ipv4Address.hasError("required")),n.xp6(1),n.Q6J("ngIf",(r.controls.ipv4Address.dirty||r.controls.ipv4Address.touched)&&r.controls.ipv4Address.hasError("invalidIPv4")),n.xp6(7),n.hij(" ",n.lcZ(29,11,r.getDeviceLabel(null==r.controls.peripheralDevices.value?null:r.controls.peripheralDevices.value[0]))," "),n.xp6(2),n.Q6J("ngIf",((null==r.controls.peripheralDevices.value?null:r.controls.peripheralDevices.value.length)||0)>1),n.xp6(1),n.Q6J("ngForOf",r.peripheralDevices),n.xp6(2),n.hij(" Max: ",r.maxDevices," "),n.xp6(5),n.Oqu(r.isEditMode?"Save":"Add"))},dependencies:[w.sg,w.O5,g._Y,g.Fj,g.JJ,g.JL,g.sg,g.u,N.lW,E.KE,E.hX,E.bx,E.TO,j.gD,j.$L,zr.ey,T.ZT,T.uh,T.H8,ct.Nt,w.rS],styles:[".dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end!important;padding:0 24px 24px}.w-half[_ngcontent-%COMP%]{width:50%}"]}),t})();var st=o(1135),jr=o(8746);class Vr{constructor(e){this._gatewaysService=e,this.gatewaysSubject=new st.X([]),this.metaSubject=new st.X({total:0}),this.loadingSubject=new st.X(!1),this.loading$=this.loadingSubject.asObservable()}connect(){return this.gatewaysSubject.asObservable()}disconnect(){this.gatewaysSubject.complete(),this.loadingSubject.complete()}loadGateways(e={}){this.loadingSubject.next(!0),this._gatewaysService.getAll(e).pipe((0,M.K)(()=>(0,ft.of)({data:[],meta:{total:0}})),(0,jr.x)(()=>this.loadingSubject.next(!1))).subscribe(a=>{this.gatewaysSubject.next(a.data),this.metaSubject.next(a.meta)})}get meta$(){return this.metaSubject.asObservable()}}var zt=o(8855);function kr(t,e){1&t&&n._UZ(0,"mat-progress-bar",20)}function ti(t,e){1&t&&(n.TgZ(0,"th",21),n._uU(1,"Serial ID"),n.qZA())}function ei(t,e){if(1&t&&(n.TgZ(0,"td",22),n._uU(1),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.Oqu(a.serialId)}}function ni(t,e){1&t&&(n.TgZ(0,"th",21),n._uU(1,"Name"),n.qZA())}function ai(t,e){if(1&t&&(n.TgZ(0,"td",22),n._uU(1),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.Oqu(a.name)}}function ri(t,e){1&t&&(n.TgZ(0,"th",21),n._uU(1,"IP"),n.qZA())}function ii(t,e){if(1&t&&(n.TgZ(0,"td",22),n._uU(1),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.Oqu(a.ipv4Address)}}function si(t,e){1&t&&(n.TgZ(0,"th",23),n._uU(1,"Peripherical Devices"),n.qZA())}function oi(t,e){if(1&t&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&t){const a=n.oxw().$implicit;n.xp6(1),n.AsE(" (+",(a.peripheralDevices.length||0)-1," ",2===a.peripheralDevices.length?"other":"others",") ")}}function li(t,e){if(1&t&&(n.TgZ(0,"td",22),n._uU(1),n.ALo(2,"titlecase"),n.YNc(3,oi,2,2,"span",24),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.hij(" ",n.lcZ(2,2,a.peripheralDevices[0].vendor)+" - "+a.peripheralDevices[0].uid," "),n.xp6(2),n.Q6J("ngIf",(a.peripheralDevices.length||0)>1)}}function ci(t,e){1&t&&(n.TgZ(0,"th",21),n._uU(1,"Created At"),n.qZA())}function di(t,e){if(1&t&&(n.TgZ(0,"td",22),n._uU(1),n.ALo(2,"date"),n.qZA()),2&t){const a=e.$implicit;n.xp6(1),n.Oqu(n.xi3(2,1,a.createdAt,"medium"))}}function ui(t,e){1&t&&(n.TgZ(0,"th",21),n._uU(1,"Actions"),n.qZA())}function fi(t,e){if(1&t){const a=n.EpF();n.TgZ(0,"td",22)(1,"button",25)(2,"mat-icon"),n._uU(3,"more_vert"),n.qZA()(),n.TgZ(4,"mat-menu",null,26)(6,"button",27),n.NdJ("click",function(){const s=n.CHM(a).$implicit,l=n.oxw();return n.KtG(l.openAddEditDialog(s))}),n._uU(7,"Edit"),n.qZA(),n.TgZ(8,"button",27),n.NdJ("click",function(){const s=n.CHM(a).$implicit,l=n.oxw();return n.KtG(l.openDeleteDialog(s._id))}),n._uU(9,"Remove"),n.qZA()()()}if(2&t){const a=n.MAs(5);n.xp6(1),n.Q6J("matMenuTriggerFor",a)}}function hi(t,e){1&t&&n._UZ(0,"tr",28)}function pi(t,e){1&t&&n._UZ(0,"tr",29)}const mi=function(){return[5,10,20]},gi=[{path:"",component:(()=>{class t{constructor(a,r,i,s){this._gatewaysService=a,this._deviceService=r,this._dialog=i,this._snackBar=s,this.devices=[],this.displayedColumns=["serialId","name","ipv4Address","peripheralDevices","createdAt","actions"]}get params(){let a=`${"desc"===this.sort?.direction?"-":""}${this.sort?.active}`;return((0,I.Qt)(this.sort)||(0,I.Qt)(this.sort?.active))&&(a="-createdAt"),{page:this.paginator?.pageIndex||0,limit:this.paginator?.pageSize||10,sort:a}}ngOnInit(){this._deviceService.getAll().pipe((0,M.K)(()=>(0,ft.of)({data:[],meta:{total:0}}))).subscribe(a=>{this.devices=a.data}),this.dataSource=new Vr(this._gatewaysService),this.dataSource.loadGateways(this.params)}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,Qt.T)(this.sort.sortChange,this.paginator.page).pipe((0,qt.b)(()=>this.loadGateways())).subscribe()}loadGateways(){this.dataSource.loadGateways(this.params)}openAddEditDialog(a){this._dialog.open(Wr,{width:"550px",disableClose:!0,data:{devices:this.devices,gatewayData:a}}).afterClosed().subscribe(i=>{i&&this.dataSource.loadGateways(this.params)})}openSnackBar(a,r="OK"){this._snackBar.open(a,r,{duration:4e3,verticalPosition:"top"})}openDeleteDialog(a){this._dialog.open(Xt.$,{data:{title:"Delete Gateway",message:"Are you sure you want to delete this gateway?"}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._gatewaysService.delete(a).subscribe(()=>{this.openSnackBar("Gateway deleted successfully!"),this.dataSource.loadGateways(this.params)})})}}return t.\u0275fac=function(a){return new(a||t)(n.Y36(it),n.Y36(zt.I),n.Y36(T.uw),n.Y36(W.ux))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-gateways"]],viewQuery:function(a,r){if(1&a&&(n.Gf(X.NW,5),n.Gf(P.YE,5)),2&a){let i;n.iGM(i=n.CRH())&&(r.paginator=i.first),n.iGM(i=n.CRH())&&(r.sort=i.first)}},decls:32,vars:13,consts:[[1,"loading-container"],["mode","indeterminate",4,"ngIf"],[1,"flex","mx-10","my-5"],["mat-flat-button","","color","primary",1,"ml-auto",3,"click"],["aria-hidden","false","aria-label","Add New gateway Icon","fontIcon","add"],[1,"mat-elevation-z8","mx-10"],["mat-table","","matSort","","aria-label","Elements",1,"full-width-table",3,"dataSource"],["matColumnDef","serialId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","ipv4Address"],["matColumnDef","peripheralDevices"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",1,"border-t",3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],[4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(a,r){if(1&a&&(n.TgZ(0,"div",0),n.YNc(1,kr,1,0,"mat-progress-bar",1),n.ALo(2,"async"),n.qZA(),n.TgZ(3,"div",2)(4,"button",3),n.NdJ("click",function(){return r.openAddEditDialog()}),n._UZ(5,"mat-icon",4),n._uU(6," Add New Gateway "),n.qZA()(),n.TgZ(7,"div",5)(8,"table",6),n.ynx(9,7),n.YNc(10,ti,2,0,"th",8),n.YNc(11,ei,2,1,"td",9),n.BQk(),n.ynx(12,10),n.YNc(13,ni,2,0,"th",8),n.YNc(14,ai,2,1,"td",9),n.BQk(),n.ynx(15,11),n.YNc(16,ri,2,0,"th",8),n.YNc(17,ii,2,1,"td",9),n.BQk(),n.ynx(18,12),n.YNc(19,si,2,0,"th",13),n.YNc(20,li,4,4,"td",9),n.BQk(),n.ynx(21,14),n.YNc(22,ci,2,0,"th",8),n.YNc(23,di,3,4,"td",9),n.BQk(),n.ynx(24,15),n.YNc(25,ui,2,0,"th",8),n.YNc(26,fi,10,1,"td",9),n.BQk(),n.YNc(27,hi,1,0,"tr",16),n.YNc(28,pi,1,0,"tr",17),n.qZA(),n._UZ(29,"mat-paginator",18,19),n.ALo(31,"async"),n.qZA()),2&a){let i;n.xp6(1),n.Q6J("ngIf",n.lcZ(2,8,r.dataSource.loading$)),n.xp6(7),n.Q6J("dataSource",r.dataSource),n.xp6(19),n.Q6J("matHeaderRowDef",r.displayedColumns),n.xp6(1),n.Q6J("matRowDefColumns",r.displayedColumns),n.xp6(1),n.Q6J("length",null==(i=n.lcZ(31,10,r.dataSource.meta$))?null:i.total)("pageIndex",0)("pageSize",10)("pageSizeOptions",n.DdM(12,mi))}},dependencies:[w.O5,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,X.NW,P.YE,P.nU,N.lW,N.RK,dt.Hw,U.VK,U.OP,U.p6,ut.pW,w.Ov,w.rS,w.uU]}),t})()}];let _i=(()=>{class t{}return t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({providers:[it,zt.I],imports:[w.ez,Jt.Bz.forChild(gi),Kt.D,g.UX,lt.JF,_.p0,X.TU,P.JX,N.ot,dt.Ps,j.LD,T.Is,ct.c,U.Tx,W.ZX,E.lN,ut.Cv]}),t})()}}]);